### 1. üí° Logging Fundamentals

- **Purpose:** Logging monitors network traffic volumes, diagnoses problems, and establishes baselines to detect anomalies.
    
- **Log Types:** The FortiGate records three main types:

###### 1. **Traffic logs**
###### 2. **Event logs** (system changes)
###### 3. **Security logs** (UTM - attacks)
    
- **Log Flow:** The firewall subjects traffic to action based on configured policies, and that action is then recorded.
    

---

### 2. üíæ Log Storage and Transport

1. **Local Storage Limits:** Logs stored locally on the **Disk** are deleted after **7 days** (default). Local log storage is capped at **75%** of the dedicated disk space.
    
2. **Remote Storage:** Logs can be sent to external devices like **Syslog servers, FortiAnalyzer, FortiCloud, FortiManager, or FortiSIEM**.
    
- **Protocols:**
    
    - **Syslog:** Uses **UDP port 514**.
        
    - **FortiAnalyzer:** Uses **TCP Protocol (OFTPS)** for secure and reliable delivery.
        
- **Configuration Note:** Log processing significantly impacts the **FortiGate's main processor**.
    

---

### 3. üß† Log Processing and Caching

- **Caching Problem:** The **`miglogd`** process is responsible for caching logs on the FortiGate. If the `miglogd` cache becomes full, the FortiGate will start to **drop logs** instead of recording them.
    

---

### 4. üö® Log Content and Severity

- **Log Layout:** Every log entry contains a **Log Header** (with Type and Security Level) and a **Log Body** (including the **policyid**, source/destination IPs, and the specific **action** taken).
    
- **Security Levels:** Logs are classified by severity from **0 - Emergency** (System unstable) down to **7 - Debug** (Diagnostics).

![[Pasted image 20251103153525.png]]



    
- **‚öñÔ∏è Threat Weight:** This setting allows you to customize the severity level (**Off, Low, High, Critical**) for different security events (e.g., malware, web filtering categories) to standardize risk assessment.
    

---

### 5. üõ†Ô∏è Log Management and Backup

- **Log Rolling:** This process compresses and archives local log files (default max size **20 MB**) to manage disk space.
    
- **Log Uploading:** Rolled logs can be automatically **uploaded to an FTP Server**. Logs are **deleted** locally after successful upload (by default).
    
- **Backup:** Logs can be exported via **FTP, TFTP, or USB** in **LZ4** compressed files.
    
- **Viewing:** You can quickly view related traffic by right-clicking on a policy and selecting **Show matching logs**.
    
- **Alerts:** **Email Alerts (SMTP)** can be configured via **System ‚Üí Settings** to notify administrators when specific security events occur.