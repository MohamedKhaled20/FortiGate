A **Certificate** is a digital file used to secure communications, serving three main functions in the inspection process:

- **1. Trust & Identity:** It verifies the identity of a website, confirming you are connecting to the legitimate server (e.g., proving ownership to a browser).
    
- **2. Encryption Key:** It contains the **public key** necessary to initiate the secure handshake and establish a secure, encrypted connection.
    
- **3. FortiGate Decryption:** For **Deep Inspection** to work, the FortiGate uses its own certificate to **impersonate** the original website. This certificate must be deployed and trusted on all user devices to avoid security warnings.

### **Inspection Types :**


![[Pasted image 20251102171447.png]]

#### **1.no-inspection:**

- **Function:** This is ==a **read-only profile that does no inspection**== at all. Encrypted traffic passes through the firewall untouched.

- **Use:** Often used for traffic that contains sensitive personal information (like financial or health data) where legal or privacy concerns prohibit decryption.
#### **2.certificate-inspection:**
    
- **Function:** This profile only performs **SSL handshake inspection**. It checks the certificate details like ==Domain Name== but ==**does not decrypt**== the data payload itself.
    
- **Use:** Identifies encrypted traffic and blocks sessions based on invalid or suspicious certificates, but does not allow the application of other security profiles (Antivirus, Web Filter, etc.).
        
####  **3.deep-inspection/ Full-inspection:**
    
  - **Function:** These profiles perform ==**full proxy-based decryption**== of the SSL/TLS traffic. The FortiGate ==acts as a Man-in-the-Middle (MITM)==, using a self-signed or CA-signed certificate to re-encrypt the traffic before sending it to the client.
  
  - **Use:** This is required to apply the firewall's full suite of **Security Profiles** (Antivirus, Web Filter, Application Control, etc.) to encrypted traffic, providing the highest level of security.




#### Example in Deep Inspection

For the FortiGate to use a profile like `custom-deep-inspection` (full decryption), it must perform a **Man-in-the-Middle (MITM)** operation:

- The FortiGate uses its own **CA certificate** (e.g., `FORTINET_CA_SSL`) to **impersonate** the original website to the end-user's device.
    
- This CA certificate must be **installed and trusted** by every client browser and operating system. If the certificate isn't trusted, the browser will display a severe security warning because it detects the MITM intervention.
    
- By trusting the FortiGate's certificate, the firewall can successfully decrypt and re-encrypt the traffic, allowing security profiles (Antivirus, Web Filter, etc.) to inspect the data payload for threats.


![[Pasted image 20251102171607.png]]

##### ðŸ›‘ Security Note: Certificate Deployment

It is **mandatory** to download the FortiGate's **signing CA certificate** (e.g., `FORTINET_CA_SSL`) and deploy it to all end-user devices (browsers/OS certificate stores) when using **Deep SSL Inspection**.

- **Why?** The FortiGate acts as a **Man-in-the-Middle (MITM)** to decrypt and inspect the traffic. It uses its own certificate to re-encrypt the data for the client.

![[Pasted image 20251102173738.png]]