## 1-üõ°Ô∏è IPS 

The **IPS** (Intrusion Prevention System) is a security profile that scans your network traffic to find and **block malicious attacks** and threats _before_ they can do damage.

First you should know the difference between:


![[fd0d3cd7734d346e9bf48a16978867a8.jpeg]]

**==IPS can just catch Exploit attack==** 

**How It Works: IPS Components**:

1. **Protocol Decoders:** These "translate" the network traffic (like HTTP or DNS) so the engine can understand it.
    
2. **IPS Engine:** This is the "brain" that does the actual scanning.
    
3. **IPS Signature Database:** This is the library of known attack "fingerprints" that the engine uses for matching.

### Step 1: Define the Virtual IP (VIP-WEB-SERVER)

![[Pasted image 20251103195745.png]]

- **Simple Definition** A **Virtual IP (VIP)** is an object that defines the **DNAT** (Destination Network Address Translation) rule. It acts as the public, external-facing address for a private, internal server.
    
- **Mechanism** The administrator is creating an object named `VIP-WEB-SERVER`. This object maps the **External IP address** (`100.65.0.200`) to the internal server's **Mapped IP address** (`10.0.11.50`). Any traffic from the internet sent to `100.65.0.200` will be automatically translated by the firewall and forwarded to the internal server at `10.0.11.50`.
    

---
### Step 2: Create a Custom IPS Profile (WEBSERVER)

![[Pasted image 20251103195846.png]]

- **Simple Definition** An **Intrusion Prevention (IPS) Profile** is a security feature that scans traffic for known attack patterns, exploits, and malicious signatures.
    
- **Mechanism** The administrator is creating a custom profile (which will be named `WEBSERVER` in the next step). This profile is being tailored to protect the web server by adding specific signatures and filters, such as those targeting the **Apache** application and high-severity (`SEV`) threats. This ensures the firewall is specifically looking for attacks that are relevant to this server.
    

---

### Step 3: Create the Enforcement Policy (Web_Server_Access_IPS)

![[Pasted image 20251103200213.png]]

- **Simple Definition** This Firewall Policy is the final step that **activates the rule** and ties the VIP (the destination) and the IPS profile (the security) together. It permits traffic from the internet to access the internal server.
    
- **Enforcement Flow**
    
    - **Traffic Flow:** The policy allows traffic from `port2` (the WAN/Internet) to `port4` (the DMZ/Server Network).
        
    - **Source:** Set to **all**, allowing any user on the internet to initiate the connection.
        
    - **Destination:** Set to the **VIP-WEB-SERVER** object. This is the crucial part: the policy only applies to traffic _destined for that public IP_.
        
    - **NAT:** **NAT is explicitly Disabled**. This is critical. The DNAT translation is already handled by the VIP object. Enabling NAT here would _also_ apply SNAT to the source address, which is typically not desired for this type of inbound access.
        
    - **Security:** The **IPS** profile `WEBSERVER` is applied, ensuring all traffic allowed by this rule is first scanned for the attacks defined in Step 2. **SSL inspection** is set to `certificate-inspection` to validate the SSL handshake without full decryption.



## 2.üñ•Ô∏è Application Control Configuration

### Step 1: Define the Application Override (Block Excessive Bandwidth)


![[Pasted image 20251103202755.png]]


- **Simple Definition** The administrator is creating a custom rule (an "Override") within the Application Control profile. This rule is not for a specific app (like "Facebook") but for a specific _behavior_.
    
- **Mechanism** This override is an `Application Filter` set to **Block** any traffic that matches the **Excessive-Bandwidth** behavioral signature. This rule is designed to automatically stop any application that consumes an unusual amount of data, even if the application itself isn't explicitly blocked (e.g., a file-sharing app running over a standard port).
    

---

### Step 2: Apply the Profile in a Firewall Policy

![[Pasted image 20251103202822.png]]

- **Simple Definition** This step activates the Application Control rules on the traffic allowed by the firewall policy.
    
- **Mechanism** In the **Security Profiles** section of the policy, **Application control** is **Enabled** and set to the `default` profile (which would contain the new "Excessive-Bandwidth" override created in Step 1).
    
- **Crucial Requirement: SSL Inspection** For this to work on modern web traffic, **SSL inspection** is also **Enabled** and set to **deep-inspection**. This is **mandatory**. Without `deep-inspection`, the firewall cannot decrypt HTTPS traffic to "see" the application's behavior, and the "Excessive-Bandwidth" signature would never be triggered.


